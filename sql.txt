
  CREATE TABLE "SWITCH"."QR_TERMINAL" 
   (	"ID" NUMBER, 
	"MASTER_MERCHANT" VARCHAR2(200 BYTE) NOT NULL ENABLE, 
	"MASTER_MERCHANT_NAME" VARCHAR2(200 BYTE), 
	"MERCHANT_CODE" VARCHAR2(200 BYTE), 
	"MERCHANT_NAME" VARCHAR2(200 BYTE), 
	"MCC_CODE" VARCHAR2(200 BYTE), 
	"MCC_NAME" VARCHAR2(200 BYTE), 
	"TERMINAL_ID" VARCHAR2(200 BYTE), 
	"TERMINAL_NAME" VARCHAR2(200 BYTE), 
	"TID_MCC_CODE" VARCHAR2(200 BYTE), 
	"TID_MCC_NAME" VARCHAR2(200 BYTE), 
	"TID_MCC_VNPAY_CODE" VARCHAR2(200 BYTE), 
	"TID_MCC_VNPAY_NAME" VARCHAR2(200 BYTE), 
	"CREATE_DATE" TIMESTAMP (6), 
	"MERCHANT_ID" LONG, 
	 CONSTRAINT "QR_TERMINAL_SYNC_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "TS_SWITCH"  ENABLE, 
	 CONSTRAINT "MMT" UNIQUE ("MASTER_MERCHANT", "MERCHANT_CODE", "TERMINAL_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "TS_SWITCH"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "TS_SWITCH" ;






















create or replace PACKAGE BODY PKG_QR_TERMINAL AS


    PROCEDURE PROC_GET_QR_TERMINAL(P_CUR OUT REFCURSOR) AS
    BEGIN
        OPEN P_CUR FOR
        SELECT 
            ID
            ,MASTER_MERCHANT
            ,MASTER_MERCHANT_NAME
            ,MERCHANT_CODE
            ,MERCHANT_NAME
            ,MCC_CODE
            ,MCC_NAME
            ,TERMINAL_ID
            ,TERMINAL_NAME
            ,TID_MCC_CODE
            ,TID_MCC_NAME
            ,TID_MCC_VNPAY_CODE
            ,TID_MCC_VNPAY_NAME
            ,CREATE_DATE
            ,MERCHANT_ID
        FROM QR_TERMINAL ORDER BY CREATE_DATE DESC;
    END PROC_GET_QR_TERMINAL;

    PROCEDURE PROC_INSERT_QR_TERMINAL (
        P_MASTER_MERCHANT        IN    QR_TERMINAL.MASTER_MERCHANT%TYPE,
        P_MASTER_MERCHANT_NAME   IN    QR_TERMINAL.MASTER_MERCHANT_NAME%TYPE,
        P_MERCHANT_CODE          IN    QR_TERMINAL.MERCHANT_CODE%TYPE,
        P_MERCHANT_NAME          IN    QR_TERMINAL.MERCHANT_NAME%TYPE,
        P_MCC_CODE               IN    QR_TERMINAL.MCC_CODE%TYPE,
        P_MCC_NAME               IN    QR_TERMINAL.MCC_NAME%TYPE,
        P_TERMINAL_ID            IN    QR_TERMINAL.TERMINAL_ID%TYPE,
        P_TERMINAL_NAME          IN    QR_TERMINAL.TERMINAL_NAME%TYPE,
        P_TID_MCC_CODE           IN    QR_TERMINAL.TID_MCC_CODE%TYPE,
        P_TID_MCC_NAME           IN    QR_TERMINAL.TID_MCC_NAME%TYPE,
        P_TID_MCC_VNPAY_CODE     IN    QR_TERMINAL.TID_MCC_VNPAY_CODE%TYPE,
        P_TID_MCC_VNPAY_NAME     IN    QR_TERMINAL.TID_MCC_VNPAY_NAME%TYPE,
        P_MERCHANT_ID            IN    QR_TERMINAL.MERCHANT_ID%TYPE,
        P_CREATE_DATE            OUT   TIMESTAMP,
        P_TRAN_ID                OUT   NUMBER
    ) AS
    BEGIN
        SELECT
            SEQ_QR_TRANSACTION.NEXTVAL
        INTO P_TRAN_ID
        FROM
            DUAL;
        SELECT SYSTIMESTAMP INTO P_CREATE_DATE FROM DUAL;
        INSERT INTO QR_TERMINAL (
            ID,
            MASTER_MERCHANT,
            MASTER_MERCHANT_NAME,
            MERCHANT_CODE,
            MERCHANT_NAME,
            MCC_CODE,
            MCC_NAME,
            TERMINAL_ID,
            TERMINAL_NAME,
            TID_MCC_CODE,
            TID_MCC_NAME,
            TID_MCC_VNPAY_CODE,
            TID_MCC_VNPAY_NAME,
            CREATE_DATE,
            MERCHANT_ID
        ) VALUES (
            P_TRAN_ID,
            P_MASTER_MERCHANT,
            P_MASTER_MERCHANT_NAME,
            P_MERCHANT_CODE,
            P_MERCHANT_NAME,
            P_MCC_CODE,
            P_MCC_NAME,
            P_TERMINAL_ID,
            P_TERMINAL_NAME,
            P_TID_MCC_CODE,
            P_TID_MCC_NAME,
            P_TID_MCC_VNPAY_CODE,
            P_TID_MCC_VNPAY_NAME,
            P_CREATE_DATE,
            P_MERCHANT_ID
        );

    END PROC_INSERT_QR_TERMINAL;

    PROCEDURE PROC_INSERT_QR_TERMINAL_TEST (
        P_MASTER_MERCHANT        OUT   STRING,
        P_MASTER_MERCHANT_NAME   IN    QR_TERMINAL_TEST.MASTER_MERCHANT_NAME%TYPE,
        P_MERCHANT_CODE          IN    QR_TERMINAL_TEST.MERCHANT_CODE%TYPE,
        P_MERCHANT_NAME          IN    QR_TERMINAL_TEST.MERCHANT_NAME%TYPE,
        P_MCC_CODE               IN    QR_TERMINAL_TEST.MCC_CODE%TYPE,
        P_MCC_NAME               IN    QR_TERMINAL_TEST.MCC_NAME%TYPE,
        P_TERMINAL_ID            IN    QR_TERMINAL_TEST.TERMINAL_ID%TYPE,
        P_TERMINAL_NAME          IN    QR_TERMINAL_TEST.TERMINAL_NAME%TYPE,
        P_TID_MCC_CODE           IN    QR_TERMINAL_TEST.TID_MCC_CODE%TYPE,
        P_TID_MCC_NAME           IN    QR_TERMINAL_TEST.TID_MCC_NAME%TYPE,
        P_TID_MCC_VNPAY_CODE     IN    QR_TERMINAL_TEST.TID_MCC_VNPAY_CODE%TYPE,
        P_TID_MCC_VNPAY_NAME     IN    QR_TERMINAL_TEST.TID_MCC_VNPAY_NAME%TYPE,
        P_MERCHANT_ID            IN    QR_TERMINAL_TEST.MERCHANT_ID%TYPE,
        P_CREATE_DATE            OUT   TIMESTAMP,
        P_TRAN_ID                OUT   NUMBER
    ) AS
    BEGIN
        SELECT SEQ_QR_TRANSACTION.NEXTVAL INTO P_TRAN_ID FROM DUAL;
        SELECT SEQ_QR_TRANSACTION.NEXTVAL||'' INTO P_MASTER_MERCHANT FROM DUAL;
        SELECT SYSTIMESTAMP INTO P_CREATE_DATE FROM DUAL;
        INSERT INTO QR_TERMINAL_TEST (
            ID,
            MASTER_MERCHANT,
            MASTER_MERCHANT_NAME,
            MERCHANT_CODE,
            MERCHANT_NAME,
            MCC_CODE,
            MCC_NAME,
            TERMINAL_ID,
            TERMINAL_NAME,
            TID_MCC_CODE,
            TID_MCC_NAME,
            TID_MCC_VNPAY_CODE,
            TID_MCC_VNPAY_NAME,
            CREATE_DATE,
            MERCHANT_ID
        ) VALUES (
            P_TRAN_ID,
            P_MASTER_MERCHANT,
            P_MASTER_MERCHANT_NAME,
            P_MERCHANT_CODE,
            P_MERCHANT_NAME,
            P_MCC_CODE,
            P_MCC_NAME,
            P_TERMINAL_ID,
            P_TERMINAL_NAME,
            P_TID_MCC_CODE,
            P_TID_MCC_NAME,
            P_TID_MCC_VNPAY_CODE,
            P_TID_MCC_VNPAY_NAME,
            P_CREATE_DATE,
            P_MERCHANT_ID
        );

    END PROC_INSERT_QR_TERMINAL_TEST;
    
END PKG_QR_TERMINAL;














create or replace PACKAGE PKG_QR_TERMINAL AS

    TYPE REFCURSOR IS REF CURSOR;

    PROCEDURE PROC_GET_QR_TERMINAL(P_CUR OUT REFCURSOR);  
    
    PROCEDURE PROC_INSERT_QR_TERMINAL (
        P_MASTER_MERCHANT        IN   QR_TERMINAL.MASTER_MERCHANT%TYPE,
        P_MASTER_MERCHANT_NAME   IN   QR_TERMINAL.MASTER_MERCHANT_NAME%TYPE,
        P_MERCHANT_CODE          IN   QR_TERMINAL.MERCHANT_CODE%TYPE,
        P_MERCHANT_NAME          IN   QR_TERMINAL.MERCHANT_NAME%TYPE,
        P_MCC_CODE               IN   QR_TERMINAL.MCC_CODE%TYPE,
        P_MCC_NAME               IN   QR_TERMINAL.MCC_NAME%TYPE,
        P_TERMINAL_ID            IN   QR_TERMINAL.TERMINAL_ID%TYPE,
        P_TERMINAL_NAME          IN   QR_TERMINAL.TERMINAL_NAME%TYPE,
        P_TID_MCC_CODE           IN   QR_TERMINAL.TID_MCC_CODE%TYPE,
        P_TID_MCC_NAME           IN   QR_TERMINAL.TID_MCC_NAME%TYPE,
        P_TID_MCC_VNPAY_CODE     IN   QR_TERMINAL.TID_MCC_VNPAY_CODE%TYPE,
        P_TID_MCC_VNPAY_NAME     IN   QR_TERMINAL.TID_MCC_VNPAY_NAME%TYPE,
        P_MERCHANT_ID            IN   QR_TERMINAL.MERCHANT_ID%TYPE,
        P_CREATE_DATE            OUT  TIMESTAMP,
        P_TRAN_ID                OUT  NUMBER
    );
    
    PROCEDURE PROC_INSERT_QR_TERMINAL_TEST (
        P_MASTER_MERCHANT        OUT   STRING,
        P_MASTER_MERCHANT_NAME   IN   QR_TERMINAL_TEST.MASTER_MERCHANT_NAME%TYPE,
        P_MERCHANT_CODE          IN   QR_TERMINAL_TEST.MERCHANT_CODE%TYPE,
        P_MERCHANT_NAME          IN   QR_TERMINAL_TEST.MERCHANT_NAME%TYPE,
        P_MCC_CODE               IN   QR_TERMINAL_TEST.MCC_CODE%TYPE,
        P_MCC_NAME               IN   QR_TERMINAL_TEST.MCC_NAME%TYPE,
        P_TERMINAL_ID            IN   QR_TERMINAL_TEST.TERMINAL_ID%TYPE,
        P_TERMINAL_NAME          IN   QR_TERMINAL_TEST.TERMINAL_NAME%TYPE,
        P_TID_MCC_CODE           IN   QR_TERMINAL_TEST.TID_MCC_CODE%TYPE,
        P_TID_MCC_NAME           IN   QR_TERMINAL_TEST.TID_MCC_NAME%TYPE,
        P_TID_MCC_VNPAY_CODE     IN   QR_TERMINAL_TEST.TID_MCC_VNPAY_CODE%TYPE,
        P_TID_MCC_VNPAY_NAME     IN   QR_TERMINAL_TEST.TID_MCC_VNPAY_NAME%TYPE,
        P_MERCHANT_ID            IN   QR_TERMINAL_TEST.MERCHANT_ID%TYPE,
        P_CREATE_DATE            OUT  TIMESTAMP,
        P_TRAN_ID                OUT  NUMBER
    );

END PKG_QR_TERMINAL;